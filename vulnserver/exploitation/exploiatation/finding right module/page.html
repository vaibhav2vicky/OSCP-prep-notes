<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>finding right module</title>
</head><body>Downloa Mona.py from github : https://github.com/corelan/mona<br/>
<br/>
paste mona.py in C:\Program files (x86)\Immunity Inc\Immunity Debugger\PyCommands<br/>
<br/>
to use mona use !mona in immunity debugger bottom bar<br/>
<br/>
<img src="2021-11-20 21_54_02-win10 [running] - or.png" /><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<img src="2021-11-20 21_55_18-win10 [running] - or.png" /><br/>
<br/>
<br/>
simillar screen should appear this is the help screen of mona.py<br/>
<br/>
use !mona modules command to see all avilable modules info<br/>
<br/>
<img src="2021-11-20 21_58_32-win10 [running] - or.png" /><br/>
<br/>
<br/>
in this the essfunc.dll stands out the most.<br/>
<br/>
sincer it has no memory protection<br/>
<br/>
next find the hex code eqivelent of JMP ESP( jump code )<br/>
using nasm_shell<br/>
<br/>
┌──(kali㉿kali)-[~]<br/>
└─$ /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb<br/>
<br/>
nasm &gt; JMP ESP<br/>
00000000 &nbsp;FFE4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;jmp esp<br/>
nasm &gt; <br/>
<br/>
The hex code is &nbsp;= FFE4<br/>
<br/>
next we try to find it in mona modules &nbsp;!mona find -s"\xff\xe4" -m essfunc.dll<br/>
<br/>
<br/>
<img src="2021-11-20 22_07_28-win10 [running] - or.png" /><br/>
<br/>
total 9 pointers found write them down and try whichever work<br/>
<br/>
<br/>
625011af written as jmpcode = "\xaf\x11\x50\x62" due to little Endian notation due to x86 architecture<br/>
<br/>
executing exploit(2).py <br/>
<br/>
and successfully changed EIP tp JMP ESP<br/>
<br/>
<img src="2021-11-20 22_26_53-win10 [running] - or.png" /><br/>
<br/>
<br/>
<br/>
<br/>
</body></html>